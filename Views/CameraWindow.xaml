<Window x:Class="SimpleDroneGCS.Views.CameraWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vlc="clr-namespace:LibVLCSharp.WPF;assembly=LibVLCSharp.WPF"
        Title="{DynamicResource Cam_Title}" 
        Height="720" Width="1280"
        Background="#0D1733"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <Style x:Key="CameraButton" TargetType="Button">
            <Setter Property="Focusable" Value="False"/>
            <Setter Property="Background" Value="#1A2744"/>
            <Setter Property="Foreground" Value="#98F019"/>
            <Setter Property="BorderBrush" Value="#2A4361"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Margin" Value="2"/>
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="4"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#2A4361"/>
                                <Setter Property="BorderBrush" Value="#98F019"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter Property="Background" Value="#98F019"/>
                                <Setter Property="Foreground" Value="#0D1733"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="HoldButton" TargetType="Button" BasedOn="{StaticResource CameraButton}">
            <Setter Property="Background" Value="#1A3344"/>
        </Style>

        <Style x:Key="GroupHeader" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#98F019"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,8,0,4"/>
        </Style>

        <Style x:Key="InfoText" TargetType="TextBlock">
            <Setter Property="Foreground" Value="#8899AA"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280"/>
        </Grid.ColumnDefinitions>

        <!-- Видео панель -->
        <Grid Grid.Column="0" Background="#060B1A">
            <vlc:VideoView x:Name="VideoView" 
                           MouseLeftButtonDown="VideoView_MouseDown"/>

            <!-- Углы подвеса -->
            <StackPanel VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10">
                <Border Background="#80000000" CornerRadius="4" Padding="8">
                    <StackPanel>
                        <TextBlock x:Name="YawText" Text="{DynamicResource Cam_Heading}" Foreground="#98F019" FontSize="12"/>
                        <TextBlock x:Name="PitchText" Text="{DynamicResource Cam_Pitch}" Foreground="#98F019" FontSize="12"/>
                        <TextBlock x:Name="RollText" Text="{DynamicResource Cam_Roll}" Foreground="#98F019" FontSize="12"/>
                        <TextBlock x:Name="DistanceText" Text="{DynamicResource Cam_Distance}" Foreground="#FF6633" FontSize="13" FontWeight="SemiBold" Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Статус -->
            <Border VerticalAlignment="Bottom" HorizontalAlignment="Left" 
                    Background="#80000000" CornerRadius="4" Padding="8" Margin="10">
                <TextBlock x:Name="StatusText" Text="{DynamicResource Ready}" Foreground="#AABBCC" FontSize="11"/>
            </Border>

            <!-- Перекрестие -->
            <Grid IsHitTestVisible="False">
                <Line X1="0" Y1="0.5" X2="1" Y2="0.5" 
                      Stretch="Fill" Stroke="#4098F019" StrokeThickness="1"
                      VerticalAlignment="Center"/>
                <Line X1="0.5" Y1="0" X2="0.5" Y2="1" 
                      Stretch="Fill" Stroke="#4098F019" StrokeThickness="1"
                      HorizontalAlignment="Center"/>
            </Grid>
        </Grid>

        <!-- Панель управления -->
        <ScrollViewer Grid.Column="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="10">

                <!-- Подключение -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Connection}" Style="{StaticResource GroupHeader}"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="IpTextBox" Text="192.168.144.68" 
                                     Background="#0D1733" Foreground="White" 
                                     BorderBrush="#2A4361" Padding="8,6"
                                     VerticalContentAlignment="Center"/>
                            <Button x:Name="ConnectButton" Content="{DynamicResource Connect}" 
                                    Grid.Column="1" Style="{StaticResource CameraButton}"
                                    Click="ConnectButton_Click" Width="95"/>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Управление подвесом -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_GimbalControl}" Style="{StaticResource GroupHeader}"/>
                        <TextBlock Text="{DynamicResource Cam_GimbalHint}" Style="{StaticResource InfoText}"/>

                        <Canvas x:Name="JoystickArea" Width="150" Height="150" 
                                Background="#0D1733" Margin="0,10"
                                MouseLeftButtonDown="JoystickArea_MouseDown"
                                MouseMove="JoystickArea_MouseMove"
                                MouseLeftButtonUp="JoystickArea_MouseUp">
                            <Ellipse Width="150" Height="150" 
                                     Stroke="#2A4361" StrokeThickness="2" Fill="Transparent"/>
                            <Ellipse Width="100" Height="100" Canvas.Left="25" Canvas.Top="25"
                                     Stroke="#1A3344" StrokeThickness="1" Fill="Transparent"/>
                            <Ellipse x:Name="JoystickThumb" Width="30" Height="30" 
                                     Canvas.Left="60" Canvas.Top="60"
                                     Fill="#98F019" Opacity="0.8"/>
                        </Canvas>

                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="{DynamicResource Cam_Center}" Style="{StaticResource CameraButton}" 
                                    Click="HomeButton_Click"/>
                            <Button Content="{DynamicResource Cam_LookDown}" Style="{StaticResource CameraButton}"
                                    Click="LookDownButton_Click"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Зум и фокус -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_ZoomFocus}" Style="{StaticResource GroupHeader}"/>
                        <TextBlock Text="{DynamicResource Cam_ZoomHint}" Style="{StaticResource InfoText}"/>

                        <UniformGrid Columns="3" Margin="0,5">
                            <Button Content="➖" Style="{StaticResource HoldButton}"
                                    PreviewMouseLeftButtonDown="ZoomOut_Down"
                                    PreviewMouseLeftButtonUp="Zoom_Up"/>
                            <Button Content="{DynamicResource Cam_Stop}" Style="{StaticResource CameraButton}"
                                    Click="ZoomStop_Click"/>
                            <Button Content="➕" Style="{StaticResource HoldButton}"
                                    PreviewMouseLeftButtonDown="ZoomIn_Down"
                                    PreviewMouseLeftButtonUp="Zoom_Up"/>
                        </UniformGrid>

                        <Button Content="{DynamicResource Cam_Autofocus}" Style="{StaticResource CameraButton}"
                                Click="AutoFocus_Click" Margin="0,5"/>
                    </StackPanel>
                </Border>

                <!-- Фото и видео -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Shooting}" Style="{StaticResource GroupHeader}"/>
                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="{DynamicResource Cam_Photo}" Style="{StaticResource CameraButton}"
                                    Click="Photo_Click"/>
                            <Button x:Name="RecordButton" Content="{DynamicResource Cam_Record}" 
                                    Style="{StaticResource CameraButton}"
                                    Click="Record_Click"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Источник видео -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_VideoSource}" Style="{StaticResource GroupHeader}"/>
                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="EO" Style="{StaticResource CameraButton}" Click="SensorEO_Click"/>
                            <Button Content="{DynamicResource Cam_IR}" Style="{StaticResource CameraButton}" Click="SensorIR_Click"/>
                            <Button Content="{DynamicResource Cam_EO_IR_PIP}" Style="{StaticResource CameraButton}" Click="SensorPIP1_Click"/>
                            <Button Content="{DynamicResource Cam_IR_EO_PIP}" Style="{StaticResource CameraButton}" Click="SensorPIP2_Click"/>
                        </UniformGrid>
                        <Button Content="{DynamicResource Cam_Fusion}" Style="{StaticResource CameraButton}" Click="SensorFusion_Click" Margin="0,2"/>
                    </StackPanel>
                </Border>

                <!-- ИК палитра (10 режимов) -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_IRPalette}" Style="{StaticResource GroupHeader}"/>
                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="{DynamicResource Cam_Pal_WhiteHot}" Style="{StaticResource CameraButton}" Tag="0" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_Lava}" Style="{StaticResource CameraButton}" Tag="1" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_RedMetal}" Style="{StaticResource CameraButton}" Tag="2" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_HotMetal}" Style="{StaticResource CameraButton}" Tag="3" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_Medical}" Style="{StaticResource CameraButton}" Tag="4" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_Arctic}" Style="{StaticResource CameraButton}" Tag="5" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_Rainbow1}" Style="{StaticResource CameraButton}" Tag="6" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_Rainbow2}" Style="{StaticResource CameraButton}" Tag="7" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_RedTrail}" Style="{StaticResource CameraButton}" Tag="8" Click="IRPalette_Click"/>
                            <Button Content="{DynamicResource Cam_Pal_BlackHot}" Style="{StaticResource CameraButton}" Tag="9" Click="IRPalette_Click"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>


                <!-- Температура -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Temperature}" Style="{StaticResource GroupHeader}"/>
                        <UniformGrid Columns="3" Margin="0,5">
                            <Button Content="Gear 1" Style="{StaticResource CameraButton}" Tag="1" Click="TempGear_Click"/>
                            <Button Content="Gear 2" Style="{StaticResource CameraButton}" Tag="2" Click="TempGear_Click"/>
                            <Button Content="Gear 3" Style="{StaticResource CameraButton}" Tag="3" Click="TempGear_Click"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Дальномер -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Rangefinder}" Style="{StaticResource GroupHeader}"/>
                        <Button Content="{DynamicResource Cam_LaserToggle}" Style="{StaticResource CameraButton}" Click="LaserToggle_Click" Margin="0,5"/>
                    </StackPanel>
                </Border>

                <!-- Подсветка и OSD -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Additional}" Style="{StaticResource GroupHeader}"/>
                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="{DynamicResource Cam_FillLight}" Style="{StaticResource CameraButton}" Click="FillLight_Click"/>
                            <Button Content="{DynamicResource Cam_OSDToggle}" Style="{StaticResource CameraButton}" Click="OSD_Click"/>
                        </UniformGrid>
                    </StackPanel>
                </Border>

                <!-- Трекинг -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10" Margin="0,0,0,10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Tracking}" Style="{StaticResource GroupHeader}"/>
                        <TextBlock Text="{DynamicResource Cam_TrackHint}" Style="{StaticResource InfoText}"/>
                        <UniformGrid Columns="2" Margin="0,5">
                            <Button Content="{DynamicResource Cam_Search}" Style="{StaticResource CameraButton}" Click="SearchMode_Click"/>
                            <Button Content="{DynamicResource Cam_Stop}" Style="{StaticResource CameraButton}" Click="StopTracking_Click"/>
                        </UniformGrid>
                        <Button Content="{DynamicResource Cam_AIToggle}" Style="{StaticResource CameraButton}" Click="ToggleAI_Click" Margin="0,2"/>
                    </StackPanel>
                </Border>

                <!-- Горячие клавиши -->
                <Border Background="#1A2744" CornerRadius="6" Padding="10">
                    <StackPanel>
                        <TextBlock Text="{DynamicResource Cam_Hotkeys}" Style="{StaticResource GroupHeader}"/>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="W/A/S/D" Foreground="#98F019"/> — управление подвесом
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="+/−" Foreground="#98F019"/> — зум
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="{DynamicResource Cam_SpaceKey}" Foreground="#98F019"/> — фото
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="R" Foreground="#98F019"/> — запись
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="H" Foreground="#98F019"/> — центр подвеса
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="F" Foreground="#98F019"/> — автофокус
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="L" Foreground="#98F019"/> — лазер вкл/выкл
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="T" Foreground="#98F019"/> — температура (gear цикл)
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="I" Foreground="#98F019"/> — подсветка
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="O" Foreground="#98F019"/> — OSD вкл/выкл
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="P" Foreground="#98F019"/> — след. палитра ИК
                        </TextBlock>
                        <TextBlock Style="{StaticResource InfoText}">
                            <Run Text="{DynamicResource Cam_CtrlClick}" Foreground="#98F019"/> — трекинг
                        </TextBlock>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
